<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<!--<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">-->
		<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />-->
		<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
	</head>
	<input type="text" /> <button class="btn btn-success">查询</button>
	<br />
	<div>
		账号：<input type="text" id="username" /><br /><br /> 密码：
		<input type="text" id="psd" /><br /><br /> 电话：
		<input type="text" id="tel" /><br /><br />
		<button id="btn" class="btn btn-success">增添</button>
		<table border="1" cellspacing="0" cellpadding="0">
			<tr>
				<th>id</th>
				<th>username</th>
				<th>password</th>
				<th>phone</th>
				<th>caozuo</th>
			</tr>
		</table>
		</body>
		<script>
			//增加
			var btn = $("#btn");
			btn[0].addEventListener("click", function() {
				var username = $("#username").val();
				var psd = $("#psd").val();
				var tel = $("#tel").val();
				$.ajax({
					type: "post",
					url: "http://127.0.0.1:8100/1505A/getAcc",
					data: {
						"user": username,
						"psd": psd,
						"tel": tel
					},
					success: function(data) {
						if(typeof data == "object") {
							alert("增添成功");
							//							window.location.href = "index.html";
						} else {
							alert("失败");
						}
					},
					error: function() {
						console.log("注册失败");
					}
				})
			}, false);

			//修改
			function updata(id) {
				//			console.log(1);
				$("#qb").click(function() {
					var a = $("#username").val();
					var b = $("#psd").val();
					var c = $("#tel").val();
					$.ajax({
						type: "post",
						url: "http://127.0.0.1:8100/1505A/getUpdata",
						data: {
							"a": a,
							"b": b,
							"c": c,
							"id": id
						},
						success: function(data) {
							if(typeof data == "object") {
								alert("修改成功");
								//window.location.href = "chaxun.html";
							} else {
								alert("失败");
							}
						},
						error: function() {
							console.log("注册失败");
						}
					})
				})
			}
			//删除
			function aja() {
				$.ajax({
					type: "post",
					url: "http://127.0.0.1:8100/1505A/getAll",
					success: function(data) {
						var a = "";
						var b = data.length;
						for(var i = 0; i < b; i++) {
							a += "<tr>";
							a += "<td>" + data[i].id + "</td>";
							a += "<td>" + data[i].username + "</td>";
							a += "<td>" + data[i].password + "</td>";
							a += "<td>" + data[i].phone + "</td>";
							a += "<td><button class='btn btn-danger' onclick='del(" + data[i].id + ")'>删除</button>";
							a += "<button class='btn btn-danger' id = 'qb' onclick='updata(" + data[i].id + ")'>修改</button></td>";
							a += "</tr>";
						}
						$("table").append(a)
					},
					error: function() {
						console.log("获取数据失败");
					}
				});
			}
			aja();

			function del(id) {
				$.ajax({
					type: "post",
					data: {
						"id": id
					},
					url: "http://127.0.0.1:8100/1505A/getAbb"
				});
				window.location.href = "chaxun.html";
			}
			//模糊查询
			$("button").on("click", function() {
				var texts = $("input").val();
				//console.log(texts)
				$.ajax({
					type: "post",
					url: "http://127.0.0.1:8100/1505A/getLike",
					data: {
						"texts": texts
					},
					success: function(data) {
						var a = "";
						a += "<tr>";
						a += "<th>id</th>";
						a += "<th>username</th>";
						a += "<th>password</th>";
						a += "<th>phone</th>";
						a += "<th>操作</th>";
						a += "</tr>";
						var b = data.length;
						for(var i = 0; i < b; i++) {
							a += "<tr>";
							a += "<td>" + data[i].id + "</td>";
							a += "<td>" + data[i].username + "</td>";
							a += "<td>" + data[i].password + "</td>";
							a += "<td>" + data[i].phone + "</td>";
							a += "<td><button class='btn btn-danger' onclick='del(" + data[i].id + ")'>删除</button>";
							a += "<button class='btn btn-danger' id = 'qb' onclick='updata()'>修改</button></td>";
							a += "</tr>";
						}
						//				$("table").remove()
						$("table").html(a)
					},
					error: function() {
						console.log("获取数据失败");
					}
				});
			})
			function thousandBitSeparator(num) {
			    return num && num.toString().replace(/(?=(?!^)(\d{3})+$)/g, ',')
		}
		console.log(thousandBitSeparator(99999999));
		</script>

</html>